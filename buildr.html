<html>
<head>
  <style>
    .highlight {background-color: yellow;}
  </style>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"></script>
  <script type="text/javascript" src="jquery.buildr.js"></script>
  <script>
    $(function(){
      var stooges = [
        {fname: 'Moe'  , lname: 'Howard', dob: '06/19/1897'},
        {fname: 'Larry', lname: 'Fine'  , dob: '10/05/1902'},
        {fname: 'Curly', lname: 'Howard', dob: '10/22/1903'}
      ];

			var colors = ['red','white','blue']; 

      var name = function(){
        return this.fname + ' ' + this.lname;
      };

      $.each(stooges, function(idx, stooge){
        stooge.name = name.bind(stooge);
      });

      var $body = $('body');

      $body.append($('<h1>').text('The Three Stooges (A1)')).
        append($('<ol>',{class: 'list'}).append(function(){
          return $.map(stooges, function(stooge, idx){
            return $('<li>').text(stooge.name()).get(0);
          });
        }));

      $body.build(function(b){
        b.h1('The Three Stooges (A)');
        b.ol({id: 'stooges'}, function(){
          $.each(stooges, function(idx, stooge){
            b.li(stooge.name()); //b.li().text(stooge.name()), b.li(stooge.name) <-- if bound;
          })
        });
      });


/*

      $body.build(function(b){ with (b){
        h1('The Three Stooges (Aa2)');
        ol({id: 'stooges'}, function(){
          $.each(stooges, function(idx, stooge){
            li(stooge.name()); //b.li().text(stooge.name()), b.li(stooge.name) <-- if bound;
          })
        });
      }});
*/

      $body.build(function(b){
        b.h1('The Three Stooges (Aa)');
        b.ol({id: 'stooges'}, stooges, function(idx, stooge){
          b.li().text(name.bind(stooge));
        });
      });


      $body.build(function(b){ with(b) {
        h1('The Three Stooges (A-color)');
        ol({id: 'stooges'}, stooges, function(idx, stooge){
          li(span(stooge.name()), colors, function(idx, color){
						span(color).css({'background-color': color});
					});
        });
      }});

      $body.build(function(b){ 
        b.h1('The Three Stooges (A-color-1)');
        b.ol({id: 'stooges'}, stooges, function(idx, stooge){
					b.li(function(){
						b.b(stooge.name);
						b.each(colors, function(idx, color){
							b.span(color).css({border: 'solid 1px ' + color});
						});
					})
        });
      });

      $body.build(function(b){ 
        b.h1('The Three Stooges (A-color-13)');
        b.ol({id: 'stooges'}, stooges, function(idx, stooge){
					b.li(function(){
						b.b(stooge.name);
						b.each(colors, b.p());
					})
        });
      });


      $body.build(function(b){ with(b) {
        h1('The Three Stooges (Aa1)');
        ol({id: 'stooges'}, stooges, function(idx, stooge){
          li().text(stooge.name());
        });
      }});

      $body.build(function(){
        this.h1('The Three Stooges (Ab)');
        this.ol(stooges, function(idx, stooge){
          this.li().text(stooge.fname + ' ' + stooge.lname);
        });
      });

////
      $body.build(function(){
        this.h1(this.b({style: 'color: red'}, 'The Three Stooges (Ac)'));
        this.ol(stooges, function(idx, stooge){
          this.li().text(stooge.fname + ' ' + stooge.lname);
        });
      });

      $body.build(function(){
        this.h1(this.b('The Three Stooges (Ac2)').css({color: 'red'}));
        this.ol(stooges, function(idx, stooge){
          this.li().text(stooge.fname + ' ' + stooge.lname);
        });
      });

      $body.build(function(b){
        b.table(function(){
          b.caption(b.b('The Three Stooges (Cz)'));
          b.each(stooges, function(idx, stooge){
            b.tr(function(){
              b.td(stooge.fname);
              b.td(stooge.lname);
              b.td(stooge.dob);
            }).click(highlight);
          })
        });
      });

      $body.build(function(b){ with(b) {
        table(function(){
          caption(b('The Three Stooges (Cz1)'));
          each(stooges, function(idx, stooge){
            tr(function(){
              td(stooge.fname);
              td(stooge.lname);
              td(stooge.dob);
            }).click(highlight);
          })
        });
      }});

      $body.build(function(b){ with(b) {
        table(function(){
          caption(b('The Three Stooges (Cz2)'));
          each(stooges, function(idx, stooge){
            tr(td(stooge.fname), td(stooge.lname), td(stooge.dob)).click(highlight);
          })
        });
      }});


////

      $body.append($.build().div(function(b){
        b.h1('The Three Stooges (B)');
        b.ol(function(){
          $.each(stooges, function(idx, stooge){
            b.li().text(stooge.fname + ' ' + stooge.lname);
          })
        });
      }));

      var highlight = function(){
        var $el = $(this);
        $el.closest('table').find('tr').removeClass('highlight');
        $el.addClass('highlight');
      };

      var highlightAll = function(){
        $(this).addClass('highlight');
      };

      $body.build(function(b){
        b.table(function(){
          b.caption(b.b('The Three Stooges (C)'));
          b.each(stooges, function(idx, stooge){
            b.tr(function(){
              b.td(stooge.fname);
              b.td(stooge.lname);
              b.td(stooge.dob);
            }).click(highlight);
          })
        });
      });

      $body.build({
        stooge: function(stooge){
          return this.tr(function(){ //calling return is optional.  use it only if you want reference to the outermost element.
            this.td(stooge.fname);
            this.td(stooge.lname);
            this.td(stooge.dob);
          }).click(highlight);
        }
      }, function(b){
        b.table(function(){
          b.caption(b.b('The Three Stooges (D)'));
          b.each(stooges, function(idx, stooge){
            b.stooge(stooge);
          });
        }).dblclick(highlightAll);
      });

      $body.build({
        stooge: function(idx, stooge){
          return this.tr(function(){ //calling return is optional.  use it only if you want reference to the outermost element.
            this.td(stooge.fname);
            this.td(stooge.lname);
            this.td(stooge.dob);
          }).click(highlight);
        }
      }, function(b){
        b.table(function(){
          b.caption('The Three Stooges (E)');
          $.each(stooges, b.stooge);
        });
      });

      var $tabular = $.build({
        stooges: function(stooges){
          return this.table(function(){
            this.caption('The Three Stooges (Table)');
            this.each(stooges, this.stooge);
          });
        },
        stooge: function(idx, stooge){
          return this.tr(function(){
            this.td(stooge.fname);
            this.td(stooge.lname);
            this.td(stooge.dob);
          }).click(highlight);
        }
      });

      var $list = $.build({
        stooges: function(stooges){
          return [this.h1('The Three Stooges (List)'),
          this.ol(function(){
            this.each(stooges, this.stooge);
          })];
        },
        stooge: function(idx, stooge){
          return this.li(stooge.fname + ' ' + stooge.lname);
        }
      });

      $body.append($tabular.build(function(b){
        b.stooges(stooges);
      }));

      $body.append($list.build(function(b){
        b.stooges(stooges);
      }));

      $body.append('<span>latest</span>');
      $body.append($tabular.stooges(stooges));
      $body.append($list.stooges(stooges));

      console.log('html', $body, $body.html());

      var $m0 = $('<html>').append(
        $('<div>').attr({id: 'myDiv0'}).append(
          $('<ul>').attr({id: 'list'}).append(
            $('<li>').addClass('test').text('hello')
          )
        )
      );

      var $md = $.build(function(b){
        return b.html(
          b.div({id: 'myDivD'},
            b.ul({id: 'list'},
              b.li({'class': 'test'}, 'hello')
            )
          )
        );
      });

      var $mh = $.build(function(b){
        return b.html(b.div({id: 'myDivH'}, b.ul({id: 'list'}, b.li({class: 'test'}, 'hello'))));
      });

      var $me = $.build().html(function(b){
        b.div({id: 'myDivE'},
          b.ul({id: 'list'},
            b.li({'class': 'test'}, 'hello')
          )
        );
      });

      var $mf = $.build().html(function(b){
        b.div({id: 'myDivF'},
          b.ul({id: 'list'},
            b.li({'class': 'test'}, 'hello')
          ).click(function(){
            alert('hi');
          })
        );
      });

      var $mg = $.build().html(function(b){
        b.div({id: 'myDivF'},
          b.ul({id: 'list'},
            b.li({'class': 'test'}, 'hello')
          ).click(function(){
            alert('hi');
          })
        );
      });

      var $m1 = $.build().html(function(b){
        b.div({id: 'myDiv1'}, function(){
          b.ul({id: 'list'}, function(){
            b.li({'class': 'test'}, 'hello');
          });
          b.footer().text('foot');
        });
      });

      var $ma = $.build().html(function(b){
        b.div({id: 'myDivA'}, function(){
          b.ul({id: 'list'}, function(){
            b.li({'class': 'test'}, 'hello');
          });
        });
      });

      var $mb = $.build(function(b){
        return b.html(function(){
          b.div({id: 'myDivB'}, function(){
            b.ul({id: 'list'}, function(){
              b.li({'class': 'test'}, 'hello');
            });
          });
        })
      });

      var $mx = $.build(function(b){ with(b) {
        html(function(){
          div({id: 'myDivX'}, function(){
            ul({id: 'list'}, function(){
              li({'class': 'test'}, {id: 'listx'}, 'hello');
            });
          });
        })
      }});

      var $mz = $.build(function(b){ with(b) {
        return html(function(){
          div({id: 'myDivZ'}, function(){
            ul({id: 'list'}, function(){
              li({'class': 'test'}, 'hello');
            });
          });
        })
      }});

      var $mc = $.build(function(b){
        return b.html(
          b.div({id: 'myDivC'},
            b.ul({id: 'list'},
              b.li({'class': 'test'}, 'hello')
            )
          )
        );
      });

      var $m2 = $.build().
        html().nest(function(){
          this.div().id('myDiv2').nest(function(){
            this.ul().id('list').nest(function(){
              this.li().class('fancy').text('hello');
            });
          });
        });

      var $m3 = $.build().
        html(function(b){
          b.div({id: 'myDiv3'}).
            append(
              b.ul({id: 'list'}).append(
                b.li({'class': 'test'}).text('goodbye')
              )
            );
        });

      var $m4 = $.build(function(b){
        return b.html(function(b){
          b.div({id: 'myDiv4'}).
            append(
              b.ul({id: 'list'}).append(
                b.li({'class': 'test'}).text('goodbye')
              )
            );
        });
      });

      var $m5 = $.build(function(b){
        return b.html(
          b.div({id: 'myDiv5'},
            b.ul({id: 'list'},
              b.li({'class': 'test'}, 'hello')
            )
          )
        );
      });

      var $m6 = $.build().html(function(b){
        b.div({id: 'myDiv6'}, function(){
          b.ul({id: 'stooges'}, function(){
            $.each(['larry','curly','moe'], function(idx, stooge){
              b.li({'class': 'funny'}, stooge);
            });
          });
        });
      });

      console.log($mx, $mz, $mh, $m6, $m0, $m1, $m2, $m3, $m4, $m5, $ma, $mb, $mc);

    });
  </script>
</head>
<body>
</body>
</html>
